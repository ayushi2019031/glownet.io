---
layout: default
---

<div class="home">
  {%- if page.title -%}
    <h1 class="page-heading">{{ page.title }}</h1>
  {%- endif -%}

  {{ content }}

  {%- if site.posts.size > 0 -%}
    
    <!-- Sticky Section Navigation -->
    <div class="sticky-nav" id="stickyNav">
      <a href="#explorations" class="nav-pill active" data-section="explorations">Explorations</a>
      <a href="#thinking-in-papers" class="nav-pill" data-section="papers">Thinking in Papers</a>
    </div>

    <!-- Tag Filter Section -->
    <div class="tag-filter-section" id="explorations">
      <h2 class="filter-heading">{{ page.list_title | default: "Explorations and Concept Breakdowns" }}</h2>
      <div class="tag-multiselect-wrapper">
        <label>Filter by topics:</label>
        <div class="tag-multiselect-dropdown">
          <button class="tag-multiselect-button" id="tagMultiselectButton">Select topics ▼</button>
          <div class="tag-multiselect-options" id="tagMultiselectOptions">
            {%- assign all_tags = "" | split: "" -%}
            {%- for post in site.posts -%}
              {%- if post.tags -%}
                {%- for tag in post.tags -%}
                  {%- unless all_tags contains tag -%}
                    {%- assign all_tags = all_tags | push: tag -%}
                  {%- endunless -%}
                {%- endfor -%}
              {%- endif -%}
            {%- endfor -%}
            {%- assign sorted_tags = all_tags | sort -%}
            {%- for tag in sorted_tags -%}
              <label class="tag-option">
                <input type="checkbox" value="{{ tag }}" class="tag-checkbox">
                <span>{{ tag }}</span>
              </label>
            {%- endfor -%}
          </div>
        </div>
      </div>
    </div>

    <!-- Blog Posts Grid -->
    <div class="blog-grid">
      {%- for post in site.posts -%}
        <article class="blog-tile" data-tags="{{ post.tags | join: ',' }}">
          <div class="tile-content">
            {%- if post.image -%}
              <div class="tile-image">
                <img src="{{ post.image | relative_url }}" alt="{{ post.title | escape }}">
              </div>
            {%- endif -%}
            <div class="tile-body">
              <h3 class="tile-title">
                <a href="{{ post.url | relative_url }}">
                  {{ post.title | escape }}
                </a>
              </h3>
              {%- if post.date -%}
                {%- assign date_format = site.minima.date_format | default: "%b %-d, %Y" -%}
                <p class="tile-date">{{ post.date | date: date_format }}</p>
              {%- endif -%}
              {%- if post.excerpt -%}
                <p class="tile-excerpt">{{ post.excerpt | strip_html | truncatewords: 30 }}</p>
              {%- endif -%}
              {%- if post.tags -%}
                <div class="tile-tags">
                  {%- for tag in post.tags -%}
                    <span class="tile-tag">{{ tag }}</span>
                  {%- endfor -%}
                </div>
              {%- endif -%}
            </div>
          </div>
        </article>
      {%- endfor -%}
    </div>

  {%- endif -%}
  
  <hr style="margin: 2rem 0; border: 0; height: 1px; background: #e0e0e0;">

  {%- if site.research.size > 0 -%}
    
    <!-- Jump Back to Explorations -->
    <div class="section-nav">
      <a href="#explorations" class="jump-link">↑ Back to Explorations</a>
    </div>

    <!-- Research Tag Filter Section -->
    <div class="tag-filter-section" id="thinking-in-papers">
      <h2 class="filter-heading">Thinking in Papers</h2>
      <div class="tag-multiselect-wrapper">
        <label>Filter by topics:</label>
        <div class="tag-multiselect-dropdown">
          <button class="tag-multiselect-button" id="researchTagMultiselectButton">Select topics ▼</button>
          <div class="tag-multiselect-options" id="researchTagMultiselectOptions">
            {%- assign all_research_tags = "" | split: "" -%}
            {%- for paper in site.research -%}
              {%- if paper.tags -%}
                {%- for tag in paper.tags -%}
                  {%- unless all_research_tags contains tag -%}
                    {%- assign all_research_tags = all_research_tags | push: tag -%}
                  {%- endunless -%}
                {%- endfor -%}
              {%- endif -%}
            {%- endfor -%}
            {%- assign sorted_research_tags = all_research_tags | sort -%}
            {%- for tag in sorted_research_tags -%}
              <label class="tag-option">
                <input type="checkbox" value="{{ tag }}" class="research-tag-checkbox">
                <span>{{ tag }}</span>
              </label>
            {%- endfor -%}
          </div>
        </div>
      </div>
    </div>

    <!-- Research Papers Grid -->
    <div class="blog-grid">
      {%- assign sorted_research = site.research | sort: "date" | reverse -%}
      {%- for paper in sorted_research -%}
        <article class="blog-tile research-tile" data-tags="{{ paper.tags | join: ',' }}">
          <div class="tile-content">
            {%- if paper.image -%}
              <div class="tile-image">
                <img src="{{ paper.image | relative_url }}" alt="{{ paper.title | escape }}">
              </div>
            {%- endif -%}
            <div class="tile-body">
              <h3 class="tile-title">
                <a href="{{ paper.url | relative_url }}">
                  {{ paper.title | escape }}
                </a>
              </h3>
              {%- if paper.date -%}
                {%- assign date_format = site.minima.date_format | default: "%b %-d, %Y" -%}
                <p class="tile-date">{{ paper.date | date: date_format }}</p>
              {%- endif -%}
              {%- if paper.excerpt -%}
                <p class="tile-excerpt">{{ paper.excerpt | strip_html | truncatewords: 30 }}</p>
              {%- endif -%}
              {%- if paper.tags -%}
                <div class="tile-tags">
                  {%- for tag in paper.tags -%}
                    <span class="tile-tag">{{ tag }}</span>
                  {%- endfor -%}
                </div>
              {%- endif -%}
            </div>
          </div>
        </article>
      {%- endfor -%}
    </div>

  {%- endif -%}

  <p class="rss-subscribe">subscribe <a href="{{ "/feed.xml" | relative_url }}">via RSS</a></p>

</div>

<script>
  // Tag filtering functionality using multi-select checkboxes
  document.addEventListener('DOMContentLoaded', function() {
    // Blog posts filtering
    const tagButton = document.getElementById('tagMultiselectButton');
    const tagOptions = document.getElementById('tagMultiselectOptions');
    const tagCheckboxes = document.querySelectorAll('.tag-checkbox');
    const blogTiles = document.querySelectorAll('.blog-tile:not(.research-tile)');
    
    // Toggle dropdown
    if (tagButton && tagOptions) {
      tagButton.addEventListener('click', function(e) {
        e.stopPropagation();
        tagOptions.classList.toggle('show');
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', function(e) {
        if (!tagOptions.contains(e.target) && e.target !== tagButton) {
          tagOptions.classList.remove('show');
        }
      });
      
      // Filter posts when checkboxes change
      tagCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const selectedTags = Array.from(tagCheckboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);
          
          if (selectedTags.length === 0) {
            // Show all posts if no tags selected
            blogTiles.forEach(tile => tile.style.display = 'block');
          } else {
            // Show posts that match ANY selected tag
            blogTiles.forEach(tile => {
              const tileTags = tile.getAttribute('data-tags');
              const tileTagArray = tileTags ? tileTags.split(',').map(t => t.trim()) : [];
              const hasMatch = selectedTags.some(tag => tileTagArray.includes(tag));
              tile.style.display = hasMatch ? 'block' : 'none';
            });
          }
        });
      });
    }
    
    // Research papers filtering
    const researchTagButton = document.getElementById('researchTagMultiselectButton');
    const researchTagOptions = document.getElementById('researchTagMultiselectOptions');
    const researchTagCheckboxes = document.querySelectorAll('.research-tag-checkbox');
    const researchTiles = document.querySelectorAll('.research-tile');
    
    // Toggle dropdown
    if (researchTagButton && researchTagOptions) {
      researchTagButton.addEventListener('click', function(e) {
        e.stopPropagation();
        researchTagOptions.classList.toggle('show');
      });
      
      // Close dropdown when clicking outside
      document.addEventListener('click', function(e) {
        if (!researchTagOptions.contains(e.target) && e.target !== researchTagButton) {
          researchTagOptions.classList.remove('show');
        }
      });
      
      // Filter papers when checkboxes change
      researchTagCheckboxes.forEach(checkbox => {
        checkbox.addEventListener('change', function() {
          const selectedTags = Array.from(researchTagCheckboxes)
            .filter(cb => cb.checked)
            .map(cb => cb.value);
          
          if (selectedTags.length === 0) {
            // Show all papers if no tags selected
            researchTiles.forEach(tile => tile.style.display = 'block');
          } else {
            // Show papers that match ANY selected tag
            researchTiles.forEach(tile => {
              const tileTags = tile.getAttribute('data-tags');
              const tileTagArray = tileTags ? tileTags.split(',').map(t => t.trim()) : [];
              const hasMatch = selectedTags.some(tag => tileTagArray.includes(tag));
              tile.style.display = hasMatch ? 'block' : 'none';
            });
          }
        });
      });
    }
    
    // Sticky nav active state tracking
    const navPills = document.querySelectorAll('.nav-pill');
    const sections = {
      'explorations': document.getElementById('explorations'),
      'papers': document.getElementById('thinking-in-papers')
    };
    
    // Update active state on scroll
    window.addEventListener('scroll', function() {
      let current = '';
      
      Object.entries(sections).forEach(([key, section]) => {
        if (section) {
          const sectionTop = section.offsetTop - 150;
          if (pageYOffset >= sectionTop) {
            current = key;
          }
        }
      });
      
      navPills.forEach(pill => {
        pill.classList.remove('active');
        if (pill.getAttribute('data-section') === current) {
          pill.classList.add('active');
        }
      });
    });
  });
</script>
